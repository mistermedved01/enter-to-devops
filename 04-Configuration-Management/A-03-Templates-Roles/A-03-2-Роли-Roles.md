[๐ ะะปะฐะฒะฝะฐั](../../README.md) โ [โ๏ธ Configuration-Management](../../README.md#-configuration-management) โ [๐ A-03-Templates-Roles](../../README.md#-a-03-templates-roles)

---

# โ๏ธA-03-2-ะะพะปะธ-Roles
> ะัะณะฐะฝะธะทะฐัะธั Ansible ะบะพะดะฐ ะฒ ัะพะปะธ: ััััะบัััะฐ, ะฟะตัะตะธัะฟะพะปัะทะพะฒะฐะฝะธะต, ะทะฐะฒะธัะธะผะพััะธ, ะฟะพะธัะบ ะธ ัะพะทะดะฐะฝะธะต ัะพะปะตะน ัะตัะตะท Ansible Galaxy.

---

<details>
<summary><b>๐ฏ ะงัะพ ัะฐะบะพะต ัะพะปะธ ะฒ Ansible</b></summary>

---

### ะะพะฝัะตะฟัะธั ัะพะปะตะน

```text
# ะะพะปะธ - ะฟะตัะตะธัะฟะพะปัะทัะตะผัะต ะบะพะผะฟะพะฝะตะฝัั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ             ะะพะปั                โ
โ        (Ansible Role)           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  โ ะะพะณะธัะตัะบะฐั ะณััะฟะฟะธัะพะฒะบะฐ      โ
โ  โ ะะตัะตะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะบะพะดะฐ      โ
โ  โ ะกัะฐะฝะดะฐััะฝะฐั ััััะบัััะฐ       โ
โ  โ ะฃะฟัะพัะตะฝะธะต ัะปะพะถะฝัั ะฟัะพะตะบัะพะฒ  โ
โ  โ ะกะพะพะฑัะตััะฒะพ ะธ ะพะฑะผะตะฝ          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# ะัะตะธะผััะตััะฒะฐ ัะพะปะตะน:
โข ะัะณะฐะฝะธะทะฐัะธั ะบะพะดะฐ ะฟะพ ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ
โข ะะตะณะบะพะต ะฟะตัะตะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะผะตะถะดั ะฟัะพะตะบัะฐะผะธ
โข ะกัะฐะฝะดะฐััะธะทะฐัะธั ััััะบัััั
โข ะฃะฟัะพัะตะฝะธะต ัะปะพะถะฝัั playbook
```

### ะกัััะบัััะฐ ัะพะปะธ

```text
# ะกัะฐะฝะดะฐััะฝะฐั ััััะบัััะฐ ัะพะปะธ
roles/
โโโ nginx/
    โโโ defaults/
    โ   โโโ main.yml          # ะะตัะตะผะตะฝะฝัะต ะฟะพ ัะผะพะปัะฐะฝะธั
    โโโ files/                # ะกัะฐัะธัะตัะบะธะต ัะฐะนะปั
    โโโ handlers/
    โ   โโโ main.yml          # ะะฑัะฐะฑะพััะธะบะธ ัะพะฑััะธะน
    โโโ meta/
    โ   โโโ main.yml          # ะะตัะฐะดะฐะฝะฝัะต ัะพะปะธ
    โโโ tasks/
    โ   โโโ main.yml          # ะัะฝะพะฒะฝัะต ะทะฐะดะฐัะธ
    โโโ templates/            # Jinja2 ัะฐะฑะปะพะฝั
    โโโ tests/               # ะขะตััั ัะพะปะธ
    โโโ vars/
        โโโ main.yml          # ะะตัะตะผะตะฝะฝัะต ัะพะปะธ
```

---

</details>

<details>
<summary><b>๐ง ะกะพะทะดะฐะฝะธะต ัะพะปะธ</b></summary>

---

### ะกะพะทะดะฐะฝะธะต ัะพะปะธ

+++bash
# ะกะพะทะดะฐะฝะธะต ัะพะปะธ ัะตัะตะท ansible-galaxy
ansible-galaxy init nginx

# ะกะพะทะดะฐะฝะธะต ัะพะปะธ ะฒัััะฝัั
mkdir -p roles/nginx/{defaults,files,handlers,meta,tasks,templates,tests,vars}
---bash

### ะัะฝะพะฒะฝัะต ัะฐะนะปั ัะพะปะธ

+++yaml
# roles/nginx/tasks/main.yml
---
- name: Install nginx
  package:
    name: nginx
    state: present

- name: Configure nginx
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
  notify: restart nginx

- name: Start nginx
  service:
    name: nginx
    state: started
    enabled: yes
---yaml

+++yaml
# roles/nginx/defaults/main.yml
---
# ะะตัะตะผะตะฝะฝัะต ะฟะพ ัะผะพะปัะฐะฝะธั
nginx_port: 80
nginx_user: www-data
document_root: /var/www/html
---yaml

---

</details>

<details>
<summary><b>๐ฏ ะะปััะตะฒัะต ะฒัะฒะพะดั</b></summary>

---

### Best Practices ัะพะปะตะน

```text
โ ะัะฟะพะปัะทัะนัะต ััะฐะฝะดะฐััะฝัั ััััะบัััั ัะพะปะตะน
โ ะะพะบัะผะตะฝัะธััะนัะต ะฟะตัะตะผะตะฝะฝัะต ะฒ defaults
โ ะัะธะผะตะฝัะนัะต ัะตะณะธ ะดะปั ะพัะณะฐะฝะธะทะฐัะธะธ
โ ะขะตััะธััะนัะต ัะพะปะธ ะฝะฐ ัะฐะทะฝัั ัะธััะตะผะฐั
โ ะัะฟะพะปัะทัะนัะต Ansible Galaxy ะดะปั ะฟะพะธัะบะฐ ะณะพัะพะฒัั ัะพะปะตะน
```

### ะงัะพ ะธะทััะฐะตะผ ะดะฐะปััะต

```text
๐ ะกะปะตะดัััะฐั ัะตะผะฐ: ะฅะตะฝะดะปะตัั ะธ ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
๐ฏ ะัะฐะบัะธะบะฐ: ะะฑัะฐะฑะพัะบะฐ ัะพะฑััะธะน ะธ ะธัะบะปััะตะฝะธะน
๐ง ะะฝััััะผะตะฝัั: ะะฐะดะตะถะฝะพััั playbook
```

---

</details>
