[ğŸ  Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ](../../README.md) â†’ [ğŸ³ Virtualization-and-Containerization](../../README.md#-virtualization-and-containerization) â†’ [ğŸ­ V-06-Production](../../README.md#-v-06-production)

---

# ğŸ³V-06-2-ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³-Ğ¸-Ğ»Ğ¾Ğ³Ğ¸
> ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸ Docker: ÑĞ±Ğ¾Ñ€ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº, Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ»Ğ¾Ğ³Ğ¾Ğ², Ñ‚Ñ€ĞµĞ¹ÑĞ¸Ğ½Ğ³, Ğ°Ğ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³ Ğ¸ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ² Ğ¸ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ¾Ğ².

---

<details>
<summary><b>ğŸ¯ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Docker</b></summary>

---

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

```text
# ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ÑÑ‚ĞµĞº Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Docker
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ğ¡Ğ±Ğ¾Ñ€ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº   â”‚    â”‚  Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…â”‚    â”‚  Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ   â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ cAdvisor      â”‚ â†’  â”‚ â€¢ Prometheus    â”‚ â†’  â”‚ â€¢ Grafana       â”‚
â”‚ â€¢ Node Exporter â”‚    â”‚ â€¢ Elasticsearch â”‚    â”‚ â€¢ Kibana        â”‚
â”‚ â€¢ Docker Stats  â”‚    â”‚ â€¢ InfluxDB      â”‚    â”‚ â€¢ Docker Dashboardâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                       â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ğ¡Ğ±Ğ¾Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ²    â”‚    â”‚  ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ»Ğ¾Ğ³Ğ¾Ğ²   â”‚    â”‚   ĞĞ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³      â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ Log Drivers   â”‚ â†’  â”‚ â€¢ ELK Stack     â”‚ â†’  â”‚ â€¢ Alertmanager  â”‚
â”‚ â€¢ Fluentd       â”‚    â”‚ â€¢ Loki          â”‚    â”‚ â€¢ PagerDuty     â”‚
â”‚ â€¢ Filebeat      â”‚    â”‚ â€¢ Graylog       â”‚    â”‚ â€¢ OpsGenie      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

```text
ğŸ“Š ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹:
â€¢ CPU Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (%) 
â€¢ ĞŸĞ°Ğ¼ÑÑ‚ÑŒ usage/limit (MB)
â€¢ Network I/O (bytes/sec)
â€¢ Disk I/O (ops/sec)
â€¢ Restart count

ğŸ—ï¸ Ğ¥Ğ¾ÑÑ‚ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°:
â€¢ Load average
â€¢ Disk usage (%)
â€¢ Memory usage
â€¢ Network traffic
â€¢ Running processes

ğŸŒ ĞšĞ»Ğ°ÑÑ‚ĞµÑ€ (Swarm):
â€¢ Node status
â€¢ Service replicas
â€¢ Task states  
â€¢ Network health
```

---

</details>

<details>
<summary><b>ğŸ“Š Ğ¡Ğ±Ğ¾Ñ€ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº</b></summary>

---

### Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Docker

```bash
# Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ² Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
docker stats

# Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼
docker stats --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}"

# Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ²ÑĞµÑ… ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ² (Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ)
docker stats --all

# ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ¸ÑĞºĞ°
docker system df
docker system df -v

# Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Docker
docker system events --filter type=container
```

### cAdvisor - ÑĞ±Ğ¾Ñ€Ñ‰Ğ¸Ğº Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ¾Ñ‚ Google

```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº cAdvisor
docker run -d \
  --name=cadvisor \
  --volume=/:/rootfs:ro \
  --volume=/var/run:/var/run:ro \
  --volume=/sys:/sys:ro \
  --volume=/var/lib/docker/:/var/lib/docker:ro \
  --volume=/dev/disk/:/dev/disk:ro \
  --publish=8080:8080 \
  --detach=true \
  gcr.io/cadvisor/cadvisor:latest

# Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº UI: http://localhost:8080
```

### Node Exporter Ğ´Ğ»Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ñ…Ğ¾ÑÑ‚Ğ°

```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº Node Exporter
docker run -d \
  --name=node-exporter \
  --net="host" \
  --pid="host" \
  --volume="/:/host:ro,rslave" \
  quay.io/prometheus/node-exporter:latest \
  --path.rootfs=/host

# ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ½Ğ° http://localhost:9100/metrics
```

### Prometheus Ğ´Ğ»Ñ ÑĞ±Ğ¾Ñ€Ğ° Ğ¸ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ

```yaml
# docker-compose.yml Ğ´Ğ»Ñ Prometheus
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/etc/prometheus/console_libraries'
      - '--web.console.templates=/etc/prometheus/consoles'
      - '--storage.tsdb.retention.time=200h'
      - '--web.enable-lifecycle'

volumes:
  prometheus_data:
```

```yaml
# prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'docker'
    static_configs:
      - targets: ['cadvisor:8080']
  - job_name: 'node'
    static_configs:
      - targets: ['node-exporter:9100']
```

---

</details>

<details>
<summary><b>ğŸ“ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ°Ğ¼Ğ¸</b></summary>

---

### Docker Log Drivers

```bash
# ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ log driver
docker info --format '{{.LoggingDriver}}'

# Ğ—Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° Ñ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¼ log driver
docker run -d \
  --log-driver=json-file \
  --log-opt max-size=10m \
  --log-opt max-file=3 \
  nginx:alpine

# Syslog driver
docker run -d \
  --log-driver=syslog \
  --log-opt syslog-address=udp://loghost:514 \
  nginx:alpine

# Journald driver
docker run -d \
  --log-driver=journald \
  nginx:alpine
```

### ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ»Ğ¾Ğ³Ğ¾Ğ²

```bash
# ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
docker logs my-container

# Ğ›Ğ¾Ğ³Ğ¸ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
docker logs -f my-container

# ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ N ÑÑ‚Ñ€Ğ¾Ğº
docker logs --tail 100 my-container

# Ğ›Ğ¾Ğ³Ğ¸ Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ¼ĞµÑ‚ĞºĞ°Ğ¼Ğ¸
docker logs -t my-container

# Ğ›Ğ¾Ğ³Ğ¸ Ğ·Ğ° Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´
docker logs --since 2024-01-01T00:00:00 my-container

# Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ÑÑ‚Ñ€Ğ¾ĞºĞµ
docker logs my-container | grep "ERROR"
```

### Centralized Logging Ñ ELK Stack

```yaml
# docker-compose.yml Ğ´Ğ»Ñ ELK
version: '3.8'

services:
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.5.0
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
    volumes:
      - es_data:/usr/share/elasticsearch/data
    ports:
      - "9200:9200"

  logstash:
    image: docker.elastic.co/logstash/logstash:8.5.0
    volumes:
      - ./logstash.conf:/usr/share/logstash/pipeline/logstash.conf
    ports:
      - "5000:5000"
    depends_on:
      - elasticsearch

  kibana:
    image: docker.elastic.co/kibana/kibana:8.5.0
    ports:
      - "5601:5601"
    depends_on:
      - elasticsearch

volumes:
  es_data:
```

---

</details>

<details>
<summary><b>ğŸ“ˆ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº</b></summary>

---

### Grafana Ğ´Ğ»Ñ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ¾Ğ²

```yaml
# docker-compose.yml Ğ´Ğ»Ñ Grafana
version: '3.8'

services:
  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana_data:/var/lib/grafana
      - ./dashboards:/etc/grafana/provisioning/dashboards
    depends_on:
      - prometheus

  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus

volumes:
  grafana_data:
  prometheus_data:
```

### ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ñ‹ Grafana

```text
ğŸ“Š Docker Host Metrics:
â€¢ CPU usage per container
â€¢ Memory usage and limits  
â€¢ Network I/O throughput
â€¢ Disk I/O operations
â€¢ Container restarts

ğŸ—ï¸ Swarm Cluster:
â€¢ Node status and resource usage
â€¢ Service replication status
â€¢ Task failures and restarts
â€¢ Network overlay health
â€¢ Volume usage

ğŸš¨ Alerting Dashboard:
â€¢ Active alerts
â€¢ Alert history
â€¢ Service health status
â€¢ Resource thresholds
```

### Docker Desktop Dashboard

```text
# Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ² Docker Desktop
â€¢ Real-time container metrics
â€¢ Resource usage graphs
â€¢ Log viewer with search
â€¢ Volume and network usage
â€¢ Easy access to container actions
```

---

</details>

<details>
<summary><b>ğŸš¨ ĞĞ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³ Ğ¸ Ğ¾Ğ¿Ğ¾Ğ²ĞµÑ‰ĞµĞ½Ğ¸Ñ</b></summary>

---

### Alertmanager Ğ´Ğ»Ñ Prometheus

```yaml
# docker-compose.yml Ğ´Ğ»Ñ Alertmanager
version: '3.8'

services:
  alertmanager:
    image: prom/alertmanager:latest
    ports:
      - "9093:9093"
    volumes:
      - ./alertmanager.yml:/etc/alertmanager/alertmanager.yml
    command:
      - '--config.file=/etc/alertmanager/alertmanager.yml'
      - '--storage.path=/alertmanager'
    depends_on:
      - prometheus
```

```yaml
# alertmanager.yml
global:
  smtp_smarthost: 'smtp.example.com:587'
  smtp_from: 'alertmanager@example.com'
  smtp_auth_username: 'user'
  smtp_auth_password: 'password'

route:
  group_by: ['alertname']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: 'web.hook'

receivers:
  - name: 'web.hook'
    webhook_configs:
      - url: 'http://127.0.0.1:5001/'
```

### ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ°Ğ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³Ğ° Ğ´Ğ»Ñ Prometheus

```yaml
# alerts.yml
groups:
  - name: docker.alerts
    rules:
      - alert: HighMemoryUsage
        expr: container_memory_usage_bytes / container_spec_memory_limit_bytes > 0.8
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High memory usage detected"
          description: "Container {{ $labels.container }} is using {{ $value }}% of its memory limit"

      - alert: ContainerRestarted
        expr: increase(container_last_seen{name=~".+"}[5m]) > 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Container restarted"
          description: "Container {{ $labels.name }} has restarted"
```

### Health checks Ğ² Docker

```yaml
# docker-compose.yml Ñ health checks
version: '3.8'

services:
  web:
    image: nginx:alpine
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

  api:
    image: node:16
    healthcheck:
      test: ["CMD", "node", "healthcheck.js"]
      interval: 30s
      timeout: 5s
      retries: 5
```

---

</details>

<details>
<summary><b>ğŸ” ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸ Ñ‚Ñ€Ğ°ÑÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ°</b></summary>

---

### Distributed Tracing Ñ Jaeger

```yaml
# docker-compose.yml Ğ´Ğ»Ñ Jaeger
version: '3.8'

services:
  jaeger:
    image: jaegertracing/all-in-one:latest
    ports:
      - "16686:16686"
      - "14268:14268"
    environment:
      - COLLECTOR_ZIPKIN_HTTP_PORT=9411

  app:
    image: my-app:latest
    environment:
      - JAEGER_AGENT_HOST=jaeger
      - JAEGER_AGENT_PORT=6831
```

### Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ»Ğ¾Ğ³Ğ¾Ğ²

```json
// Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ»Ğ¾Ğ³ Ğ² JSON Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "ERROR",
  "service": "api-gateway",
  "container_id": "abc123",
  "message": "Failed to connect to database",
  "error": "Connection timeout",
  "duration_ms": 5000,
  "user_id": "user-123",
  "request_id": "req-456"
}
```

### ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

```bash
# ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ CPU ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
docker exec my-container perf record -g -p 1

# ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
docker exec my-container cat /sys/fs/cgroup/memory/memory.stat

# Ğ¡ĞµÑ‚ĞµĞ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
docker exec my-container cat /sys/class/net/eth0/statistics/rx_bytes

# I/O ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
docker exec my-container iostat -x 1
```

---

</details>

<details>
<summary><b>ğŸ—ï¸ Production-ready Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸</b></summary>

---

### ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Swarm ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°

```yaml
# docker-stack.yml Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Swarm
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - prometheus_data:/prometheus
    configs:
      - source: prometheus_config
        target: /etc/prometheus/prometheus.yml
    deploy:
      placement:
        constraints:
          - node.role == manager

  node-exporter:
    image: prom/node-exporter:latest
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    command:
      - '--path.procfs=/host/proc'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.ignored-mount-points'
      - '^/(sys|proc|dev|host|etc)($$|/)'
    deploy:
      mode: global

configs:
  prometheus_config:
    file: ./prometheus.yml
```

### Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² production

```yaml
# Production log configuration
version: '3.8'

services:
  app:
    image: my-app:latest
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
        labels: "production"
        env: "os,customer"

  nginx:
    image: nginx:alpine
    logging:
      driver: "syslog"
      options:
        syslog-address: "tcp://logstash:5000"
        tag: "nginx"
```

### Ğ Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ°Ñ†Ğ¸Ñ Ğ»Ğ¾Ğ³Ğ¾Ğ²

```bash
# ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° logrotate Ğ´Ğ»Ñ Docker
sudo cat > /etc/logrotate.d/docker << EOF
/var/lib/docker/containers/*/*.log {
  rotate 7
  daily
  compress
  delaycompress
  missingok
  copytruncate
}
EOF

# ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ»Ğ¾Ğ³Ğ¾Ğ²
du -sh /var/lib/docker/containers/*/*.log | sort -hr
```

---

</details>

<details>
<summary><b>ğŸ”§ Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¸ ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹</b></summary>

---

### ctop - Ñ‚Ğ¾Ğ¿ Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ctop
curl -fsSL https://azlux.fr/repo.gpg.key | sudo gpg --dearmor -o /usr/share/keyrings/azlux-archive-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/azlux-archive-keyring.gpg] http://packages.azlux.fr/debian stable main" | sudo tee /etc/apt/sources.list.d/azlux.list
sudo apt update && sudo apt install docker-ctop

# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
ctop
```

### DockStation - GUI Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

```text
# Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ DockStation:
â€¢ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°Ğ¼Ğ¸
â€¢ Real-time Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²
â€¢ ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹
â€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ¾Ğ¼Ğ¾Ğ² Ğ¸ ÑĞµÑ‚ĞµĞ¹
â€¢ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Docker Compose Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°Ğ¼Ğ¸
```

### Loki Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³Ğ¾Ğ²

```yaml
# docker-compose.yml Ğ´Ğ»Ñ Loki
version: '3.8'

services:
  loki:
    image: grafana/loki:latest
    ports:
      - "3100:3100"
    command: -config.file=/etc/loki/local-config.yaml

  promtail:
    image: grafana/promtail:latest
    volumes:
      - /var/log:/var/log
      - /var/lib/docker/containers:/var/lib/docker/containers:ro
    command: -config.file=/etc/promtail/config.yml

  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
```

---

</details>

<details>
<summary><b>ğŸ¯ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ñ‹</b></summary>

---

### Best Practices Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

```text
âœ… ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€ÑŒÑ‚Ğµ Ğ½Ğ° Ğ²ÑĞµÑ… ÑƒÑ€Ğ¾Ğ²Ğ½ÑÑ…: ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹, Ñ…Ğ¾ÑÑ‚, ĞºĞ»Ğ°ÑÑ‚ĞµÑ€
âœ… Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ»Ğ¾Ğ³Ğ¸ Ğ´Ğ»Ñ Ğ»ĞµĞ³ĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ°Ğ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³ Ğ½Ğ° ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
âœ… Ğ¥Ñ€Ğ°Ğ½Ğ¸Ñ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾ Ğ¾Ñ‚ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
âœ… Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ¹Ñ‚Ğµ Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞ¹Ñ‚Ğµ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ñ‹
âœ… Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ°Ğ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³Ğ°
âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ retention Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº
```

### ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ Ğ°Ğ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³Ğ°

```text
ğŸš¨ High CPU usage (>80% Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ)
ğŸš¨ High memory usage (>90% Ğ¾Ñ‚ limit)
ğŸš¨ Ğ§Ğ°ÑÑ‚Ñ‹Ğµ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚Ñ‹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²
ğŸš¨ Network connectivity issues
ğŸš¨ Disk space running out
ğŸš¨ Service replica count mismatch
ğŸš¨ Node not ready Ğ² ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğµ
```

### ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ÑÑ‚ĞµĞº Ğ´Ğ»Ñ production

```text
ğŸ“Š ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸: Prometheus + Node Exporter + cAdvisor
ğŸ“ˆ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ: Grafana Ñ Docker Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ°Ğ¼Ğ¸
ğŸ“ Ğ›Ğ¾Ğ³Ğ¸: Loki Ğ¸Ğ»Ğ¸ ELK Stack
ğŸš¨ ĞĞ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³: Alertmanager Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸ÑĞ¼Ğ¸
ğŸ” Ğ¢Ñ€Ğ°ÑÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ°: Jaeger Ğ´Ğ»Ñ distributed tracing
ğŸ› ï¸ Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹: ctop, dockerd events, docker stats
```

---

</details>
