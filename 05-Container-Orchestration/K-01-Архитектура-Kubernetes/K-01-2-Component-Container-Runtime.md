[üè† –ì–ª–∞–≤–Ω–∞—è](../../README.md) ‚Üí [‚ò∏Ô∏è Container-Orchestration](../../README.md#-container-orchestration) ‚Üí [üìö K-01-–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-Kubernetes](../../README.md#-k-01-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-kubernetes)

---

# ‚ò∏Ô∏èK-01-2-Component-Container-Runtime
>Container Runtime Interface (CRI), Docker, containerd, CRI-O, —ç–≤–æ–ª—é—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤ –≤ Kubernetes

---

<details>
<summary><b>üê≥–≠–≤–æ–ª—é—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤</b></summary>

---

## –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

### Docker (2013-2020)
- **–ü–∏–æ–Ω–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏**
- –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: runtime, build, registry
- Kubernetes –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ —Å Docker

### –ü—Ä–æ–±–ª–µ–º—ã Docker –≤ Kubernetes:
- **–ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å** - Kubernetes –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ Docker
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å** - –º–Ω–æ–≥–æ —Å–ª–æ–µ–≤ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
- **CRI —Å—Ç–∞–Ω–¥–∞—Ä—Ç** - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –µ–¥–∏–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### Containerd (—Å 2020)
- **–í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º** –∏–∑ Docker
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç CRI** (Container Runtime Interface)
- **–ë–æ–ª–µ–µ –ª–µ–≥–∫–∏–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π**
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–Ω—Ç–∞–π–º** –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

---

</details>

<details>
<summary><b>üîßContainer Runtime Interface (CRI)</b></summary>

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ CRI?

```go
// CRI - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤
type RuntimeService interface {
    CreateContainer(podSandboxID string, config *ContainerConfig) (string, error)
    StartContainer(containerID string) error
    StopContainer(containerID string, timeout int64) error
    // ...
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ CRI:**
- ‚úÖ **–ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** –≤ Kubernetes
- ‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–∞–Ω—Ç–∞–π–º—ã:

- **containerd** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
- **CRI-O** (—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è Kubernetes)  
- **Docker (—á–µ—Ä–µ–∑ dockershim)** - —É—Å—Ç–∞—Ä–µ–ª
- **Mirantis Container Runtime** - –∑–∞–º–µ–Ω–∞ Docker

---

</details>

<details>
<summary><b>‚öôÔ∏èDocker vs Containerd: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ</b></summary>

---

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Docker
```
Docker Daemon
    ‚Üì
containerd
    ‚Üì
runc
    ‚Üì
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä
---+

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Containerd
```
containerd
    ‚Üì
runc  
    ‚Üì
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä
---+

## –ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è

| –ê—Å–ø–µ–∫—Ç | Docker | Containerd |
|--------|--------|------------|
| **–†–∞–∑–º–µ—Ä** | ~400MB | ~50MB |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | –ú–Ω–æ–≥–æ | –ú–∏–Ω–∏–º—É–º |
| **CRI –ø–æ–¥–¥–µ—Ä–∂–∫–∞** | –ß–µ—Ä–µ–∑ dockershim | –ù–∞—Ç–∏–≤–Ω–∞—è |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –•–æ—Ä–æ—à–∞—è | –õ—É—á—à–∞—è |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** | –í—ã—Å–æ–∫–∞—è | –ù–∏–∑–∫–∞—è |

---

</details>

<details>
<summary><b>üõ†Ô∏è–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</b></summary>

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–Ω—Ç–∞–π–º–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–¥—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ä–∞–Ω—Ç–∞–π–º
kubectl get nodes -o wide

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–º —Ä–∞–Ω—Ç–∞–π–º–µ
kubectl describe node <node-name> | grep Container

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é containerd –Ω–∞ –Ω–æ–¥–µ
containerd --version
```

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å Docker –Ω–∞ Containerd

### 1. –î—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–¥—ã
```bash
kubectl drain <node-name> --ignore-daemonsets
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ containerd
```bash
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è containerd
cat /etc/containerd/config.toml

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ containerd
systemctl restart containerd
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ kubelet
```bash
# –í /var/lib/kubelet/kubeadm-flags.env
--container-runtime=remote
--container-runtime-endpoint=unix:///run/containerd/containerd.sock
```

---

</details>

<details>
<summary><b>üîç–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º</b></summary>

---

## –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Containerd –Ω–µ –∑–∞–ø—É—â–µ–Ω
```bash
systemctl status containerd
journalctl -u containerd -f
```

### 2. –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–∑–∞–º–∏
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—Ä–∞–∑—ã –≤ containerd
crictl images

# –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –æ–±—Ä–∞–∑
crictl rmi <image-id>
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
# –°–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
crictl ps

# –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
crictl logs <container-id>
```

---

</details>

<details>
<summary><b>üéØ–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</b></summary>

---

## Best Practices

### –í—ã–±–æ—Ä —Ä–∞–Ω—Ç–∞–π–º–∞:
- ‚úÖ **Containerd** - –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- ‚úÖ **CRI-O** - –¥–ª—è security-focused –æ–∫—Ä—É–∂–µ–Ω–∏–π
- ‚ùå **Docker** - –∏–∑–±–µ–≥–∞—Ç—å –≤ –Ω–æ–≤—ã—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è—Ö

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ containerd:
```bash
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è production
[plugins."io.containerd.grpc.v1.cri"]
  sandbox_image = "registry.k8s.io/pause:3.9"
  
[plugins."io.containerd.grpc.v1.cri".containerd]
  snapshotter = "overlayfs"
  discard_unpacked_layers = true
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- **–ú–µ—Ç—Ä–∏–∫–∏ containerd** - –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–õ–æ–≥–∏ runtime** - –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º
- **Health checks** - —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

</details>

<details>
<summary><b>üí°–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</b></summary>

---

1. **üìå Containerd** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ Kubernetes
2. **üìå CRI** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–Ω—Ç–∞–π–º–∞–º–∏  
3. **üìå Docker deprecated** - –º–∏–≥—Ä–∏—Ä—É–π—Ç–µ –Ω–∞ containerd
4. **üìå –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - containerd –ª–µ–≥—á–µ –∏ –±—ã—Å—Ç—Ä–µ–µ
5. **üìå –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** - –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–æ—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

> üí° **–°–æ–≤–µ—Ç:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å—Ä–∞–∑—É –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ containerd - —ç—Ç–æ —Å—ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º.

</details>

---