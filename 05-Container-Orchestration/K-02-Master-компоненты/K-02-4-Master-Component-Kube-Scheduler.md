[üè† –ì–ª–∞–≤–Ω–∞—è](../../README.md) ‚Üí [‚ò∏Ô∏è Container-Orchestration](../../README.md#-container-orchestration) ‚Üí [üéõÔ∏è K-02-Master-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](../../README.md#-k-02-master-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)

---

# üéõÔ∏èK-02-4-Master-Component-Kube-Scheduler
>kube-scheduler - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç Pod'—ã –ø–æ –Ω–æ–¥–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø–æ–ª–∏—Ç–∏–∫

---

<details>
<summary><b>üéØ–†–æ–ª—å kube-scheduler</b></summary>

---

## –ê–Ω–∞–ª–æ–≥–∏—è —Å –∫–æ—Å–º–∏—á–µ—Å–∫–∏–º –∫—Ä–∞–Ω–æ–≤—â–∏–∫–æ–º

**kube-scheduler** - —ç—Ç–æ –ª–æ–≥–∏—Å—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π:

- ‚úÖ **–ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è** –æ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ Pod'–æ–≤
- ‚ùå **–ù–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç** Pod'—ã (—ç—Ç–æ –¥–µ–ª–∞–µ—Ç kubelet)
- ‚úÖ **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç** —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ Pod'–æ–≤ –∏ –Ω–æ–¥
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏

## –ü–æ—á–µ–º—É –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫?

```
# –ö–∞–ø–∏—Ç–∞–Ω—ã (kubelet) —É–º–µ—é—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã,
# –Ω–æ –ª–æ–≥–∏—Å—Ç–∏–∫—É –ª—É—á—à–µ –¥–æ–≤–µ—Ä–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É (scheduler)

kubelet = –∫–∞–ø–∏—Ç–∞–Ω –∫–æ—Ä–∞–±–ª—è
scheduler = –æ–ø—ã—Ç–Ω—ã–π –ª–æ–≥–∏—Å—Ç —Å—Ç–∞–Ω—Ü–∏–∏
```

**–ó–∞–¥–∞—á–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:**
- üìä –£—á–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–æ–¥ (CPU, –ø–∞–º—è—Ç—å, GPU)
- üéØ –£—á–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–¥ (SSD, GPU, –∑–æ–Ω—ã)
- üó∫Ô∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è
- ‚öñÔ∏è –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ

---

</details>

<details>
<summary><b>üîß–ü—Ä–æ—Ü–µ—Å—Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</b></summary>

---

## –î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º

### –≠—Ç–∞–ø 1: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–æ–¥
```
# –û—Ç—Å–µ–∏–≤–∞–µ–º –Ω–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç
–í—Å–µ –Ω–æ–¥—ã ‚Üí –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è ‚Üí –ü–æ–¥—Ö–æ–¥—è—â–∏–µ –Ω–æ–¥—ã
    ‚Üì           ‚Üì             ‚Üì
 [node1]    –†–µ—Å—É—Ä—Å—ã CPU?    [node3]
 [node2] ‚îÄ‚îÄ√ó –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç ‚îÄ‚îÄ‚Üí [node4] 
 [node3]    –†–µ—Å—É—Ä—Å—ã CPU?    
 [node4]                    [node5]
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- üîπ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ CPU/–ø–∞–º—è—Ç–∏?
- üîπ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ª–∏ taints/tolerations?
- üîπ –ü–æ–¥—Ö–æ–¥–∏—Ç –ª–∏ node selector?
- üîπ –î–æ—Å—Ç—É–ø–Ω—ã –ª–∏ –ø–æ—Ä—Ç—ã?

### –≠—Ç–∞–ø 2: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–¥
```
# –û—Ü–µ–Ω–∏–≤–∞–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –Ω–æ–¥—ã –ø–æ —à–∫–∞–ª–µ 0-10
–ü–æ–¥—Ö–æ–¥—è—â–∏–µ –Ω–æ–¥—ã ‚Üí –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –õ—É—á—à–∞—è –Ω–æ–¥–∞
     ‚Üì               ‚Üì             ‚Üì
   [node3]        node3: 8/10    [node4]
   [node4] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí node4: 9/10 ‚îÄ‚îÄ‚Üí
   [node5]        node5: 7/10
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è:**
- üíØ –°–≤–æ–±–æ–¥–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –ø–æ—Å–ª–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
- üìç –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –∑–æ–Ω—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- üîó Affinity/anti-affinity –ø—Ä–∞–≤–∏–ª–∞
- ‚öñÔ∏è –ë–∞–ª–∞–Ω—Å –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ

---

</details>

<details>
<summary><b>üìä–ü—Ä–∏–º–µ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</b></summary>

---

## –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### Pod'—ã –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è:
```
Pod A: —Ç—Ä–µ–±—É–µ—Ç 2 CPU, 4GB –ø–∞–º—è—Ç–∏
Pod B: —Ç—Ä–µ–±—É–µ—Ç 4 CPU, 2GB –ø–∞–º—è—Ç–∏  
Pod C: —Ç—Ä–µ–±—É–µ—Ç 10 CPU, 8GB –ø–∞–º—è—Ç–∏  ‚Üê "–∂–∏—Ä–Ω—ã–π" Pod
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–¥—ã:
```
Node 1: 4 CPU —Å–≤–æ–±–æ–¥–Ω–æ, 8GB –ø–∞–º—è—Ç–∏
Node 2: 6 CPU —Å–≤–æ–±–æ–¥–Ω–æ, 4GB –ø–∞–º—è—Ç–∏
Node 3: 16 CPU —Å–≤–æ–±–æ–¥–Ω–æ, 16GB –ø–∞–º—è—Ç–∏
```

## –ü—Ä–æ—Ü–µ—Å—Å –¥–ª—è Pod C (10 CPU)

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:
```
Node 1: 4 CPU < 10 CPU ‚Üí ‚ùå –û—Ç—Å–µ—è–Ω
Node 2: 6 CPU < 10 CPU ‚Üí ‚ùå –û—Ç—Å–µ—è–Ω
Node 3: 16 CPU ‚â• 10 CPU ‚Üí ‚úÖ –ü—Ä–æ—à–µ–ª
```

### –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ:
```
Node 3: 16 CPU - 10 CPU = 6 CPU —Å–≤–æ–±–æ–¥–Ω–æ
–†–µ–π—Ç–∏–Ω–≥: 9/10 (–º–Ω–æ–≥–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Pod C –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –Ω–∞ Node 3

---

</details>

<details>
<summary><b>üõ†Ô∏è–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</b></summary>

---

## –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```
# –°–∫–∞—á–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫ kube-scheduler
wget https://github.com/kubernetes/kubernetes/releases/download/v1.28.0/kubernetes-server-linux-amd64.tar.gz

# –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
tar -xzf kubernetes-server-linux-amd64.tar.gz
cd kubernetes/server/bin
cp kube-scheduler /usr/local/bin/
```

## –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```
kube-scheduler \
  --kubeconfig=/etc/kubernetes/scheduler.conf \
  --bind-address=0.0.0.0 \
  --leader-elect=true \
  --config=/etc/kubernetes/scheduler-config.yaml
```

## –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|------------|
| `--kubeconfig` | –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API |
| `--leader-elect` | –í—ã–±–æ—Ä –ª–∏–¥–µ—Ä–∞ –¥–ª—è HA |
| `--config` | –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ |
| `--bind-address` | –ê–¥—Ä–µ—Å –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è |

---

</details>

<details>
<summary><b>üîç–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</b></summary>

---

## –î–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ kubeadm

```
# kube-scheduler —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Pod
kubectl get pods -n kube-system | grep scheduler

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç Pod
cat /etc/kubernetes/manifests/kube-scheduler.yaml

# –ò–ª–∏ —á–µ—Ä–µ–∑ kubectl
kubectl get pod kube-scheduler-node1 -n kube-system -o yaml
```

## –î–ª—è —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å systemd service
cat /etc/systemd/system/kube-scheduler.service

# –ò–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep kube-scheduler

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ü–µ—Å—Å—É
ps -ef | grep kube-scheduler | grep -v grep
```

## –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```
# kubeadm –∫–ª–∞—Å—Ç–µ—Ä
/etc/kubernetes/manifests/kube-scheduler.yaml
/etc/kubernetes/scheduler.conf

# –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞  
/etc/systemd/system/kube-scheduler.service
/etc/kubernetes/scheduler-config.yaml
```

---

</details>

<details>
<summary><b>‚öôÔ∏è–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</b></summary>

---

## –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏

```
# –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
apiVersion: kubescheduler.config.k8s.io/v1beta1
kind: KubeSchedulerConfiguration
profiles:
  - schedulerName: default-scheduler
    plugins:
      score:
        enabled:
        - name: NodeResourcesFit
        - name: NodeAffinity
        - name: InterPodAffinity
```

## –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏

```
# –ú–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
apiVersion: v1
kind: Pod
metadata:
  name: my-pod
spec:
  schedulerName: my-custom-scheduler  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
  containers:
  - name: nginx
    image: nginx
```

---

</details>

---

## –†–µ–∑—é–º–µ

‚úÖ **kube-scheduler** ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç control plane, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Pod'–æ–≤ –ø–æ –Ω–æ–¥–∞–º

‚úÖ **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- –†–µ—à–µ–Ω–∏–µ, –∞ –Ω–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Äî scheduler —Ä–µ—à–∞–µ—Ç –∫—É–¥–∞, kubelet –∑–∞–ø—É—Å–∫–∞–µ—Ç
- –î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è + —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ ‚Äî —Ä–µ—Å—É—Ä—Å—ã, –ø–æ–ª–∏—Ç–∏–∫–∏, affinity
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ—Å—Ç—å ‚Äî –º–æ–∂–Ω–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å
- –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ leader election

‚úÖ **–ü—Ä–æ—Ü–µ—Å—Å –≤ –¥–µ—Ç–∞–ª—è—Ö:**
```
–ù–æ–≤—ã–π Pod ‚Üí Scheduler ‚Üí –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è ‚Üí –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –í—ã–±–æ—Ä –Ω–æ–¥—ã
     ‚Üì          ‚Üì           ‚Üì           ‚Üì           ‚Üì
   –°–æ–∑–¥–∞–Ω    –ê–Ω–∞–ª–∏–∑      –û—Ç—Å–µ–≤      –û—Ü–µ–Ω–∫–∞     –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
   –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º   –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö   –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö   –ª—É—á—à–µ–π –Ω–æ–¥–µ
```

> üöÄ **–î–∞–ª—å—à–µ:** –†–∞—Å—Å–º–æ—Ç—Ä–∏–º kubelet - –∞–≥–µ–Ω—Ç –Ω–∞ —Ä–∞–±–æ—á–∏—Ö –Ω–æ–¥–∞—Ö, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª–Ω—è–µ—Ç —Ä–µ—à–µ–Ω–∏—è scheduler.

---