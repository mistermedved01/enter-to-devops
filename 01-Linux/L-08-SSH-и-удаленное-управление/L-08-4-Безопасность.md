[üè† –ì–ª–∞–≤–Ω–∞—è](../../README.md) ‚Üí [üêß Linux](../../README.md#-linux) ‚Üí [üîê L-08-SSH-–∏-—É–¥–∞–ª–µ–Ω–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ](../../README.md#-l-08-ssh-–∏-—É–¥–∞–ª–µ–Ω–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

---

# üîêL-08-4-–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

## –¢–µ–æ—Ä–∏—è

### –£–≥—Ä–æ–∑—ã SSH
- Brute force –∞—Ç–∞–∫–∏
- Man-in-the-middle –∞—Ç–∞–∫–∏
- –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π
- –°–ª–∞–±–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ root –ª–æ–≥–∏–Ω–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ IP
- –†–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π

## –ü—Ä–∞–∫—Ç–∏–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH —Å–µ—Ä–≤–µ—Ä–∞

#### –ë–∞–∑–æ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH
sudo nano /etc/ssh/sshd_config

# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
Port 2222                    # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
PermitRootLogin no           # –ó–∞–ø—Ä–µ—Ç –≤—Ö–æ–¥–∞ –ø–æ–¥ root
PasswordAuthentication no    # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –ø–∞—Ä–æ–ª—é
PubkeyAuthentication yes    # –í–∫–ª—é—á–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –∫–ª—é—á–∞–º
PermitEmptyPasswords no     # –ó–∞–ø—Ä–µ—Ç –ø—É—Å—Ç—ã—Ö –ø–∞—Ä–æ–ª–µ–π
MaxAuthTries 3              # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
```

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```bash
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
AllowUsers admin developer
AllowGroups ssh-users

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ IP
AllowUsers admin@192.168.1.0/24

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Å—Å–∏–∏
ClientAliveInterval 300
ClientAliveCountMax 2
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ SSH
sudo tail -f /var/log/auth.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
sudo grep "Failed password" /var/log/auth.log

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç brute force
sudo apt install fail2ban
sudo systemctl enable fail2ban
```

### –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞
ssh-keygen -t ed25519 -f ~/.ssh/new_key

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id -i ~/.ssh/new_key.pub user@server

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∫–ª—é—á–∞
ssh user@server "sed -i '/old_key/d' ~/.ssh/authorized_keys"
```

---

‚úçÔ∏è**–í–æ–ø—Ä–æ—Å—ã**

1. –ö–∞–∫–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —É–≥—Ä–æ–∑—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ SSH?

2. –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç brute force –∞—Ç–∞–∫?

3. –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSH —Å–µ—Ä–≤–µ—Ä –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏?

4. –ö–∞–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è?

5. –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã SSH?

6. –ö–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ SSH –ø–æ IP –∞–¥—Ä–µ—Å–∞–º?

7. –ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –ø–∞—Ä–æ–ª—é?

8. –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é SSH –∫–ª—é—á–µ–π?

9. –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ SSH –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å?

10. –ö–∞–∫–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å?
